# 抽奖系统更新说明

## 新增功能

### 1. 抽奖券自动扣减机制
- **功能描述**：每次抽奖后，中奖者的抽奖券数量自动减少1张
- **实现逻辑**：
  - 抽奖完成后，系统自动找到中奖者并扣减其抽奖券数量
  - 抽奖券数量为0的参与者将不再参与后续抽奖
  - 实时更新参与者名单中的抽奖券显示
  - 实时更新统计数据中的总抽奖券数

### 2. 抽奖记录显示功能
- **功能描述**：新增抽奖记录区域，显示历史抽奖信息
- **记录内容**：
  - 序号（按时间倒序排列）
  - 抽奖时间（精确到秒）
  - 中奖者姓名
  - 中奖者年级
  - 中奖者分校
  - 中奖后剩余抽奖券数量
- **显示规则**：
  - 最多显示最近10次抽奖记录
  - 最新记录显示在最上方
  - 支持清空所有抽奖记录功能

## 界面优化

### 1. 抽奖结果显示优化
- 增加"剩余抽奖券"信息显示
- 添加"抽奖券已自动扣减1张"提示信息
- 优化中奖信息的展示布局

### 2. 新增抽奖记录区域
- 采用与参与者名单相同的表格样式
- 清晰的标题和说明文字
- 独立的"清空记录"按钮

## 技术改进

### 1. 数据结构优化
- 新增 `lotteryRecords` 数组存储抽奖记录
- 抽奖记录包含完整的中奖者信息快照
- 支持时间戳记录和格式化显示

### 2. 抽奖算法优化
- 修改抽奖算法，只考虑有抽奖券的参与者
- 增加边界条件处理，防止无效抽奖
- 优化随机算法的公平性

### 3. 用户体验提升
- 实时数据更新，所有相关显示同步刷新
- 清晰的操作反馈和状态提示
- 保持原有功能的完整性

## 使用说明

### 抽奖券扣减机制
1. 每次抽奖后，中奖者的抽奖券自动减少1张
2. 当参与者抽奖券为0时，将不再参与后续抽奖
3. 统计数据会实时更新，反映当前可用抽奖券总数

### 抽奖记录查看
1. 在页面底部的"抽奖记录"区域查看历史记录
2. 记录按时间倒序排列，最新的在最上方
3. 可以通过"清空记录"按钮清除所有历史记录

### 数据管理
- "清空所有数据"按钮会同时清除参与者和抽奖记录
- "清空记录"按钮只清除抽奖记录，保留参与者数据
- 所有操作都有确认提示，防止误操作

## 兼容性说明
- 保持与原版本的完全兼容
- 所有原有功能正常工作
- 新功能为增量更新，不影响现有使用方式

